<app-body-page [spinner]="spinner">
  <div body>
    <table class="elevation-2" mat-table [dataSource]="dataSource" *ngIf="dataSource">
      <ng-container *ngFor="let column of columns;  first as isFirst; last as isLast" [matColumnDef]="column.columnDef">
        <th mat-header-cell *matHeaderCellDef>{{column.header}}</th>
        <td mat-cell *matCellDef="let row">
          <div *ngIf="column.remove" class="position-relative">
            <button mat-mini-fab color="warn" (click)="remover(row)" class="btn-remover"><i
                class="fas fa-times"></i></button>
          </div>
          <div *ngIf="column.cell">
            <div *ngIf="!column?.img">
              <span class="mobile-label">{{column.header}}:</span>
              <span style="font-size: 1rem;">{{column?.currency ? ((row.produto.price * row.quantidade) | currency) :
                column.cell(row)}}</span>
            </div>
            <div *ngIf="column?.img" class="mt-2 mb-2 div-img-produto">
              <img [src]="column.cell(row)" [alt]="row.description" class="img-produto">
            </div>
          </div>
          <div class="button-carrinho" *ngIf="!column.cell && column?.actions && column.columnDef === 'actions'">
            <app-add-remove-carrinho [item]="row" (novaQuantidade)="row.quantidade= $event">
            </app-add-remove-carrinho>
          </div>
        </td>
      </ng-container>
      <ng-container matColumnDef="total">
        <td mat-footer-cell *matFooterCellDef colspan="4">
          <span class="mobile-hidden">Total</span>
        </td>
      </ng-container>
      <ng-container matColumnDef="valorTotal">
        <td mat-footer-cell *matFooterCellDef colspan="2" class="total-mobile">
          <span class="mobile-label">Total:</span>
          <span>{{getTotal() | currency}}</span>
        </td>
      </ng-container>
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell border" colspan="9999">
          <h5 class="mb-0 text-center table-empty">Carrinho vazio!</h5>
        </td>
      </tr>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      <tr mat-footer-row *matFooterRowDef="['total', 'valorTotal']" class="footer-style"></tr>
    </table>
    <mat-paginator [pageSizeOptions]="[5, 10, 20, 50, 100]" showFirstLastButtons aria-label="Selecione as páginas">
    </mat-paginator>
    <form [formGroup]="form">
      <div class="col-md-12 observacao-concluir">
        <div class="row">
        <label>Observações:</label>
        <textarea type="text" class="observacao-text-box" formControlName="observacao" id="txt-observacao"></textarea>
        </div>
      </div>
    </form>
  </div>
</app-body-page>

<div class="btn-absolute">
  <button mat-fab color="primary" class="btn btn-pattern" matTooltip="Concluir Pedido" aria-label="Concluir Pedido"
    (click)="openModalConfirmConcluir()">
    <i class="fas fa-check"></i>
  </button>
</div>
